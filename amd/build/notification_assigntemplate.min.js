/**
 *
 * @module   local_notificationsagent/assigntemplate
 * @copyright 2023, ISYC
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_notificationsagent/notification_assigntemplate",[],(function(){return{init:function(){var idtemplate,module=this;$("#assignTemplateModal").on("show.bs.modal",(function(event){var button=$(event.relatedTarget);idtemplate=button.data("idtemplate");var modal=$(this);modal.find(".modal-title > span").text($("#card-"+idtemplate+" .badge").text()),modal.find(".badge").text($("#card-"+idtemplate+" .badge").text()),modal.find(".badge").attr("class","mr-2 "+$("#card-"+idtemplate+" .badge").attr("class")),modal.find(".modal-body .name").text($("#card-"+idtemplate+" .name").text()),$.ajax({type:"POST",url:"/local/notificationsagent/assignrule.php",data:{idRule:idtemplate},success:function(listofCoursesAssigned){listofCoursesAssigned.forEach((idcourse=>{var courseassigned=$("#assignTemplateModal .category-listing input#checkboxcourse-"+idcourse);courseassigned.length&&(courseassigned.prop("checked",!0),module.loopatfirstparent(courseassigned.attr("data-parent")).forEach((idcategory=>{module.checkhascategoryparent(idcategory)})))}))},error:function(XMLHttpRequest,textStatus,errorThrown){console.log("Status: "+textStatus),console.log(errorThrown)},dataType:"json"})})),$("#assignTemplateModal").on("hide.bs.modal",(function(){$("#assignTemplateModal .custom-control-input").prop("checked",!1)})),$("#assignTemplateModal .collapse").on("show.bs.collapse",(function(){$(this).parents(".listitem-category").removeClass("collapsed")})),$("#assignTemplateModal .collapse").on("hide.bs.collapse",(function(){$(this).parents(".listitem-category").addClass("collapsed")})),$("#assignTemplateModal #course-category-select-all").on("click",(function(){$("#assignTemplateModal .category-listing .custom-control-input").prop("checked",$(this).prop("checked"))})),$("#assignTemplateModal .category-listing").on("change","input[type=checkbox]",(function(){var checkssubcategoriescourses="#category-listing-content-"+$(this).attr("id").replace("checkboxcategory-","")+" .custom-control-input";($("#assignTemplateModal .category-listing "+checkssubcategoriescourses).prop("checked",$(this).prop("checked")),"#category-listing-content-0"!=$(this).attr("data-parent"))&&module.loopatfirstparent($(this).attr("data-parent")).forEach((idcategory=>{module.checkhascategoryparent(idcategory)}));var arrayCategoriesfirstlevel=$('#assignTemplateModal .category-listing input[type=checkbox][data-parent="#category-listing-content-0"]'),allelementsatchecked=!0;arrayCategoriesfirstlevel.each((function(){if(!$(this).prop("checked"))return allelementsatchecked=!1,!1})),allelementsatchecked?$("#assignTemplateModal #course-category-select-all").prop("checked",!0):$("#assignTemplateModal #course-category-select-all").prop("checked","")})),$("#assignTemplateModal #saveassignTemplateModal").on("click",(function(){var $arrayCourses=[];$('#assignTemplateModal .category-listing input[id^="checkboxcourse-"]').each((function(){1==$(this).prop("checked")&&$arrayCourses.push($(this).attr("id").replace("checkboxcourse-",""))}));let data={arrayCourses:$arrayCourses,idRule:idtemplate};$.ajax({type:"POST",url:"/local/notificationsagent/assignrule.php",data:data,success:function(addlistofcoursesassigned){window.location.reload()},error:function(XMLHttpRequest,textStatus,errorThrown){console.log("Status: "+textStatus),console.log(errorThrown)},dataType:"json"})}))},checkhascategoryparent:function(idparent){var allelementscatchecked=!0;$("#assignTemplateModal .category-listing #category-listing-content-"+idparent+" .custom-control-input").each((function(){if(!$(this).prop("checked"))return allelementscatchecked=!1,!1})),allelementscatchecked?$("#assignTemplateModal .category-listing #listitem-category-"+idparent+" > .category-listing-header .custom-control-input").prop("checked",!0):$("#assignTemplateModal .category-listing #listitem-category-"+idparent+" > .category-listing-header .custom-control-input").prop("checked","")},loopatfirstparent:function(idparent){let arrayParents=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];var module=this;if("#category-listing-content-0"!=idparent){arrayParents.push(idparent.replace("#category-listing-content-",""));var dataparent=$("#assignTemplateModal .category-listing #listitem-category-"+idparent.replace("#category-listing-content-","")+" > .category-listing-header .custom-control-input").attr("data-parent");return module.loopatfirstparent(dataparent,arrayParents)}return arrayParents}}}));

//# sourceMappingURL=notification_assigntemplate.min.js.map