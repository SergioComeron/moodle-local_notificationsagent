/**
 * Module javascript to place new actions.
 *
 * @module   mod_simplemod/notification_newaction
 * @category  Classes - autoloading
 * @copyright 2023, ISYC
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_notificationsagent/notification_newaction",[],(function(){return{init:function(){document.querySelector('[id*="newaction_button"]').addEventListener("click",(function(){let newActionSelect=document.querySelector('[id*="newaction_select"]'),$title=newActionSelect.options[newActionSelect.selectedIndex].text,$formDefault=[];if(window.location.href.includes("action=edit")){var ruleid=new URL(window.location.href).searchParams.get("ruleid");ruleid&&$formDefault.push("[id]ruleid[/id][value]"+ruleid+"[/value]")}let formNotif=document.querySelector('form[action*="notificationsagent"].mform');Array.from(formNotif.elements).forEach((element=>{element.id&&$formDefault.push("[id]"+element.id+"[/id][value]"+element.value+"[/value]")}));let data={key:"action",action:"new",title:$title,elements:JSON.parse(newActionSelect.value.split(":")[1]),name:newActionSelect.options[newActionSelect.selectedIndex].value.substring(0,newActionSelect.options[newActionSelect.selectedIndex].value.indexOf(":[")),formDefault:$formDefault};$.ajax({type:"POST",url:window.location.pathname.substring(0,"/local/notificationsagent/editrule.php"),data:data,success:function(event){"success"===event.state&&window.location.reload()},error:function(XMLHttpRequest,textStatus,errorThrown){console.log("Status: "+textStatus),console.log(errorThrown)},dataType:"json"})}))}}}));

//# sourceMappingURL=notification_newaction.min.js.map