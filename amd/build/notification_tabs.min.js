/**
 * Module javascript to place new conditions.
 *
 * @module    notification_tabs
 * @category  Classes - autoloading
 * @copyright 2023, ISYC
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
require(["core/copy_to_clipboard"]),define("local_notificationsagent/notification_tabs",[],(function(){var FormCondition=function(idButton,idSelect,key){this.init(idButton,idSelect,key),this.registerEvents()};return FormCondition.prototype.buttonSelector=!1,FormCondition.prototype.registerEvents=function(){var self=this;window.addEventListener("beforeunload",(event=>{self.buttonSelector&&event.stopImmediatePropagation(),self.buttonSelector=!1}),!0)},FormCondition.prototype.init=function(idButton,idSelect,key){var self=this;document.querySelector('[id*="'+idButton+'"]').addEventListener("click",(function(){self.buttonSelector=!0;let select=document.querySelector('[id*="'+idSelect+'"]');if(select.options[select.selectedIndex].dataset.type){let selectValue=select.options[select.selectedIndex].value;return void document.getElementById(selectValue).click()}let $title=select.options[select.selectedIndex].text,$formDefault=[];if(window.location.href.includes("action=edit")){var ruleid=new URL(window.location.href).searchParams.get("ruleid");ruleid&&$formDefault.push("[id]ruleid[/id][value]"+ruleid+"[/value]")}let formNotif=document.querySelector('form[action*="notificationsagent"].mform');Array.from(formNotif.elements).forEach((element=>{element.id&&$formDefault.push("[id]"+element.id+"[/id][value]"+element.value+"[/value]")}));let $elements=JSON.parse(select.value.split(":")[1]),$name=select.options[select.selectedIndex].value.substring(0,select.options[select.selectedIndex].value.indexOf(":[")),$availabilityconditionsjson=document.getElementById("id_availabilityconditionsjson").value,data={key:key,action:"new",title:$title,elements:$elements,name:$name,formDefault:$formDefault,availabilityconditionsjson:$availabilityconditionsjson};$.ajax({type:"POST",url:window.location.pathname.substring(0,"/local/notificationsagent/editrule.php"),data:data,success:function(event){"success"===event.state&&window.location.reload()},error:function(XMLHttpRequest,textStatus,errorThrown){console.log("Status: "+textStatus),console.log(errorThrown)},dataType:"json"})}))},{init:function(idButton,idSelect,key){new FormCondition(idButton,idSelect,key)}}}));

//# sourceMappingURL=notification_tabs.min.js.map