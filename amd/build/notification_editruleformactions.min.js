/**
 * Module javascript to place conditionremove.
 *
 * @module    notification_conditionremove
 * @category  Classes - autoloading
 * @copyright 2023, ISYC
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_notificationsagent/notification_editruleformactions",[],(function(){var FormConditionRemove=function(){this.init(),this.registerEvents()};return FormConditionRemove.prototype.buttonSelector=!1,FormConditionRemove.prototype.registerEvents=function(){var self=this;window.addEventListener("beforeunload",(event=>{self.buttonSelector&&event.stopImmediatePropagation(),self.buttonSelector=!1}),!0)},FormConditionRemove.prototype.init=function(){var self=this;document.querySelectorAll("h5>i.icon[id*='_']:not(.disabled)").forEach((function(button){button.addEventListener("click",(function(event){self.buttonSelector=!0;let $typesection=event.target.id.split("_")[0].replace(/[0-9]/g,""),$actionelement=event.target.id.split("_")[1],$keyelementsession=parseInt(event.target.id.replace($typesection,"").replace("_remove","")),$formDefault=[];if(window.location.href.includes("action=edit")){var ruleid=new URL(window.location.href).searchParams.get("ruleid");ruleid&&$formDefault.push("[id]ruleid[/id][value]"+ruleid+"[/value]")}let formNotif=document.querySelector('form[action*="notificationsagent"].mform'),idSectionRemove="";Array.from(formNotif.elements).forEach((element=>{if(element.id){var keySection=(elementID=element.id).split("_"+$typesection).pop().split("_")[0];if(element.id.includes("_"+$typesection)&&idSectionRemove&&idSectionRemove<keySection)var elementID=element.id.split($typesection+keySection).join($typesection+(keySection-1));element.id.includes($typesection+($keyelementsession+1))?idSectionRemove=$keyelementsession+1:$formDefault.push("[id]"+elementID+"[/id][value]"+element.value+"[/value]")}}));let $availabilityconditionsjson=document.getElementById("id_availabilityconditionsjson").value,data={key:$typesection,action:$actionelement,keyelementsession:$keyelementsession,formDefault:$formDefault,availabilityconditionsjson:$availabilityconditionsjson};"conditionexception"===data.key&&(data.key=data.key.replace(/condition/,"")),$.ajax({type:"POST",url:window.location.pathname.substring(0,"/local/notificationsagent/editrule.php"),data:data,success:function(event){"success"===event.state&&window.location.reload()},error:function(XMLHttpRequest,textStatus,errorThrown){console.log("Status: "+textStatus),console.log(errorThrown)},dataType:"json"})}))}))},{init:function(){new FormConditionRemove}}}));

//# sourceMappingURL=notification_editruleformactions.min.js.map