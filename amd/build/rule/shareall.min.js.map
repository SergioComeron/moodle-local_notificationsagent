{"version":3,"file":"shareall.min.js","sources":["../../src/rule/shareall.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n// Project implemented by the \\\"Recovery, Transformation and Resilience Plan.\n// Funded by the European Union - Next GenerationEU\\\".\n//\n// Produced by the UNIMOODLE University Group: Universities of\n// Valladolid, Complutense de Madrid, UPV/EHU, León, Salamanca,\n// Illes Balears, Valencia, Rey Juan Carlos, La Laguna, Zaragoza, Málaga,\n// Córdoba, Extremadura, Vigo, Las Palmas de Gran Canaria y Burgos.\n\n/**\n * Version details\n *\n * @package    local_notificationsagent\n * @copyright  2023 Proyecto UNIMOODLE\n * @author     UNIMOODLE Group (Coordinator) <direccion.area.estrategia.digital@uva.es>\n * @author     ISYC <soporte@isyc.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {get_strings as getStrings} from 'core/str';\nimport Notification from 'core/notification';\nimport {shareAllRule} from 'local_notificationsagent/rule/repository';\n\nexport const init = () => {\n    $('#shareAllRuleModal').on('show.bs.modal', function (e) {\n        shareAllRuleBtn = $(e.relatedTarget);\n        let id = shareAllRuleBtn.data('ruleid');\n\n        const modal = $(this);\n\n        const requiredStrings = [\n            {key: 'sharealltitle', component: 'local_notificationsagent', param: {\n                title: $('#card-' + id + ' .name').text()\n            }},\n            {key: 'shareallcontent', component: 'local_notificationsagent', param: {\n                title: $('#card-' + id + ' .name').text()\n            }},\n        ];\n\n        getStrings(requiredStrings).then(([ruleTitle, ruleContent]) => {\n            modal.find('.modal-title').text(ruleTitle);\n            modal.find('.modal-body > div').text(ruleContent);\n        });\n    });\n\n    $('#shareAllRuleModal #acceptShareAllRule').on('click', (e) => {\n        e.preventDefault();\n        setShareAllRule(shareAllRuleBtn);\n    });\n};\n\n/**\n * Approves the sharing status for a given rule\n * \n * @param {HTMLElement} ruleButton\n * @returns {Promise<void>}\n */\nconst setShareAllRule = async(shareAllRuleBtn) => {\n    let id = shareAllRuleBtn.data('ruleid');\n\n    $('#shareAllRuleModal').modal('hide');\n\n    try {\n        response = await shareAllRule(id);\n        \n        if ($.isEmptyObject(response['warnings'])) {\n            window.location.reload();\n        } else {\n            Notification.addNotification({\n                message: response['warnings'][0].message,\n                type: 'error'\n            });\n        }\n    } catch (exception) {\n        Notification.exception(exception);\n    }\n};"],"names":["$","on","e","shareAllRuleBtn","relatedTarget","id","data","modal","this","requiredStrings","key","component","param","title","text","then","_ref","ruleTitle","ruleContent","find","preventDefault","setShareAllRule","async","response","isEmptyObject","window","location","reload","addNotification","message","type","exception"],"mappings":";;;;;;;;;oKAoCoB,KAChBA,EAAE,sBAAsBC,GAAG,iBAAiB,SAAUC,GAClDC,gBAAkBH,EAAEE,EAAEE,mBAClBC,GAAKF,gBAAgBG,KAAK,gBAExBC,MAAQP,EAAEQ,MAEVC,gBAAkB,CACpB,CAACC,IAAK,gBAAiBC,UAAW,2BAA4BC,MAAO,CACjEC,MAAOb,EAAE,SAAWK,GAAK,UAAUS,SAEvC,CAACJ,IAAK,kBAAmBC,UAAW,2BAA4BC,MAAO,CACnEC,MAAOb,EAAE,SAAWK,GAAK,UAAUS,+BAIhCL,iBAAiBM,MAAKC,WAAEC,UAAWC,kBAC1CX,MAAMY,KAAK,gBAAgBL,KAAKG,WAChCV,MAAMY,KAAK,qBAAqBL,KAAKI,mBAI7ClB,EAAE,0CAA0CC,GAAG,SAAUC,IACrDA,EAAEkB,iBACFC,gBAAgBlB,2BAUlBkB,gBAAkBC,MAAAA,sBAChBjB,GAAKF,gBAAgBG,KAAK,UAE9BN,EAAE,sBAAsBO,MAAM,YAG1BgB,eAAiB,4BAAalB,IAE1BL,EAAEwB,cAAcD,SAAQ,UACxBE,OAAOC,SAASC,+BAEHC,gBAAgB,CACzBC,QAASN,SAAQ,SAAa,GAAGM,QACjCC,KAAM,UAGhB,MAAOC,iCACQA,UAAUA"}