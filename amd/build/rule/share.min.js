define("local_notificationsagent/rule/share",["exports","core/str","core/notification","local_notificationsagent/rule/repository"],(function(_exports,_str,_notification,_repository){var obj;
/**
   * Version details
   *
   * @package    local_notificationsagent
   * @copyright  2023 Proyecto UNIMOODLE
   * @author     UNIMOODLE Group (Coordinator) <direccion.area.estrategia.digital@uva.es>
   * @author     ISYC <soporte@isyc.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_notification=(obj=_notification)&&obj.__esModule?obj:{default:obj};const RULE_SHARE_SHARED=0,RULE_SHARE_UNSHARED=1,RULE_SHARE_STRING=[{key:"shareaccept",component:"local_notificationsagent"},{key:"unshareaccept",component:"local_notificationsagent"}];_exports.init=()=>{$("#shareRuleModal").on("show.bs.modal",(function(e){shareRuleBtn=$(e.relatedTarget);let id=shareRuleBtn.data("ruleid"),shareValue=shareRuleBtn.data("value");shareValue=shareValue?RULE_SHARE_UNSHARED:RULE_SHARE_SHARED;const modal=$(this),requiredStrings=[[{key:"sharetitle",component:"local_notificationsagent",param:{title:$("#card-"+id+" .name").text()}},{key:"sharecontent",component:"local_notificationsagent",param:{title:$("#card-"+id+" .name").text()}}],[{key:"unsharetitle",component:"local_notificationsagent",param:{title:$("#card-"+id+" .name").text()}},{key:"unsharecontent",component:"local_notificationsagent",param:{title:$("#card-"+id+" .name").text()}}]];(0,_str.get_strings)(requiredStrings[shareValue]).then((_ref=>{let[ruleTitle,ruleContent]=_ref;modal.find(".modal-title").text(ruleTitle),modal.find(".modal-body > div").text(ruleContent)}))})),$("#shareRuleModal #acceptShareRule").on("click",(e=>{e.preventDefault(),setRuleShare(shareRuleBtn)}))};const setRuleShare=async shareRuleBtn=>{let id=shareRuleBtn.data("ruleid"),status=shareRuleBtn.data("value");status=status?RULE_SHARE_UNSHARED:RULE_SHARE_SHARED,$("#shareRuleModal").modal("hide");try{response=await(0,_repository.updateRuleShare)(id,status),$.isEmptyObject(response.warnings)?(shareRuleBtn.addClass("d-none"),(0,_str.get_strings)(RULE_SHARE_STRING).then((_ref2=>{let[ruleShared,ruleUnshared]=_ref2;status?($('a[data-ruleid="'+id+'"][data-target="#shareRuleModal"][data-value="0"]').removeClass("d-none"),_notification.default.addNotification({message:ruleUnshared,type:"info"})):($('a[data-ruleid="'+id+'"][data-target="#shareRuleModal"][data-value="1"]').removeClass("d-none"),_notification.default.addNotification({message:ruleShared,type:"info"}))}))):_notification.default.addNotification({message:response.warnings[0].message,type:"error"})}catch(exception){_notification.default.exception(exception)}}}));

//# sourceMappingURL=share.min.js.map