/**
 * Module javascript to place the placeholders.
 * Modified version of IOMAD Email template emailvars.
 *
 * @module   mod_simplemod/notification_placeholders
 * @category  Classes - autoloading
 * @copyright 2023, ISYC
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */ define([],function(){return{init:function(){for(var e=this,t=document.getElementsByClassName("clickforword"),i=0;i<t.length;i++)t[i].addEventListener("click",function(t){t.preventDefault();var i=t.target.closest("div.notificationvars").getAttribute("id").replace("notificationvars","");e.insertAtCaret("{"+this.getAttribute("data-text")+"}",i)})},insertAtCaret:function(e,t){var i,n;if("None"!==window.getSelection().type&&(void 0!==$(window.getSelection().baseNode).closest("[id^='id_'][id*='"+t+"'][id$='editable']").attr("id")||void 0!==$(window.getSelection().focusNode).closest("[id^='id_'][id*='"+t+"'][id$='editable']").attr("id"))){if((i=window.getSelection()).getRangeAt&&i.rangeCount){(n=i.getRangeAt(0)).deleteContents(),n.insertNode(document.createTextNode(e));for(let d=0;d!=e.length+1;d++)i.modify("move","right","character")}}else document.querySelectorAll("[id^='id_'][id*='"+t+"'][id$='editable']")[0].appendChild(document.createTextNode(e))}}});