/**
 * Module javascript to place new actions.
 *
 * @module   mod_simplemod/notification_newaction
 * @category  Classes - autoloading
 * @copyright 2023, ISYC
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */ define([],function(){return{init:function(){document.querySelector('[id*="newaction_button"]').addEventListener("click",function(){let e=document.querySelector('[id*="newaction_select"]'),t=e.options[e.selectedIndex].text,n=[];Array.from(document.querySelector('form[action*="notificationsagent"].mform').elements).forEach(e=>{e.id&&n.push("[id]"+e.id+"[/id][value]"+e.value+"[/value]")});let o=JSON.parse(e.value.split(":")[1]),i=e.options[e.selectedIndex].value.substring(0,e.options[e.selectedIndex].value.indexOf(":["));$.ajax({type:"POST",url:window.location.pathname.substring(0,"/local/notificationsagent/editrule.php"),data:{key:"action",action:"new",title:t,elements:o,name:i,formDefault:n},success:function(e){"success"===e.state&&window.location.reload()},error:function(e,t,n){console.log("Status: "+t),console.log(n)},dataType:"json"})})}}});